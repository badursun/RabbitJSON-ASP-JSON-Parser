<%@ Language=VBScript %>
<%
Response.ContentType = "text/html"

' VBScript IIf equivalent function
Function IIf(condition, trueValue, falseValue)
    If condition Then
        IIf = trueValue
    Else
        IIf = falseValue
    End If
End Function
%>
<!-- #include file="../RabbitJSON.v2.asp" -->
<!DOCTYPE html>
<html>
<head>
    <title>üê∞ RabbitJSON v2.1.1 - Comprehensive Demo</title>
    <meta charset="utf-8">
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .container { max-width: 1400px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .header { text-align: center; color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 20px; margin-bottom: 30px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); padding: 25px; border-radius: 10px; }
        h1 { color: #2c3e50; margin: 0; }
        h2 { color: #34495e; margin-top: 30px; border-bottom: 2px solid #bdc3c7; padding-bottom: 10px; }
        h3 { color: #7f8c8d; }
        .demo-section { margin: 25px 0; padding: 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: #fafbfc; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .info-box { padding: 15px; border-radius: 8px; margin: 15px 0; }
        .success { background: #d5f4e6; border-left: 5px solid #27ae60; color: #155724; }
        .error { background: #fadbd8; border-left: 5px solid #e74c3c; color: #721c24; }
        .warning { background: #fef9e7; border-left: 5px solid #f39c12; color: #856404; }
        .info { background: #d1ecf1; border-left: 5px solid #17a2b8; color: #0c5460; }
        .performance { background: #e7f3ff; border-left: 5px solid #007bff; color: #0056b3; }
        .code { font-family: 'Courier New', monospace; background: #2c3e50; color: #ecf0f1; padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 14px; }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        th, td { padding: 10px; text-align: left; border: 1px solid #bdc3c7; }
        th { background: #34495e; color: white; font-weight: bold; }
        .metric { display: inline-block; margin: 10px; padding: 15px; background: linear-gradient(135deg, #3498db, #2980b9); color: white; border-radius: 8px; min-width: 120px; text-align: center; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        .null { color: #95a5a6; font-style: italic; }
        .number { color: #e67e22; font-weight: bold; }
        .boolean { color: #9b59b6; font-weight: bold; }
        .string { color: #27ae60; }
        .url { color: #3498db; text-decoration: underline; word-break: break-all; }
        .tabs { display: flex; margin-bottom: 20px; }
        .tab { padding: 12px 20px; background: #ecf0f1; border: 1px solid #bdc3c7; cursor: pointer; border-radius: 8px 8px 0 0; margin-right: 5px; }
        .tab.active { background: #3498db; color: white; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }
        .stat-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; text-align: center; }
    </style>
    <script>
        function showTab(tabName) {
            // Hide all tab contents
            var contents = document.getElementsByClassName('tab-content');
            for (var i = 0; i < contents.length; i++) {
                contents[i].classList.remove('active');
            }
            
            // Remove active class from all tabs
            var tabs = document.getElementsByClassName('tab');
            for (var i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            
            // Show selected tab content and mark tab as active
            document.getElementById(tabName + '-content').classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
        }
    </script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üê∞ RabbitJSON v2.1.1 - Comprehensive Demo</h1>
            <p><strong>All-in-One JSON Processing Demonstration</strong></p>
            <p>File Loading ‚Ä¢ HTTP Loading ‚Ä¢ Path Access ‚Ä¢ Serialization ‚Ä¢ Performance</p>
        </div>

        <%
        ' ===========================================
        ' PERFORMANCE TRACKING & INITIALIZATION
        ' ===========================================
        Dim startTime, parseTime, endTime, totalTime
        Dim json, parsedData, testResults
        startTime = Timer
        
        Set json = CreateRabbitJSON()
        Set testResults = Server.CreateObject("Scripting.Dictionary")
        
        ' Demo configuration
        Dim demoSampleFile, demoApiUrl1, demoApiUrl2
        demoSampleFile = "sample-data.json"
        demoApiUrl1 = "https://jsonplaceholder.typicode.com/posts/1"
        demoApiUrl2 = "https://api.github.com/users/octocat"
        %>

        <!-- Navigation Tabs -->
        <div class="tabs">
            <div class="tab active" id="file-tab" onclick="showTab('file')">üìÅ File Loading</div>
            <div class="tab" id="http-tab" onclick="showTab('http')">üåê HTTP Loading</div>
            <div class="tab" id="analysis-tab" onclick="showTab('analysis')">üìä Data Analysis</div>
            <div class="tab" id="performance-tab" onclick="showTab('performance')">‚ö° Performance</div>
        </div>

        <!-- Tab 1: File Loading Demo -->
        <div id="file-content" class="tab-content active">
            <div class="demo-section">
                <h2>üìÅ JSON File Loading Demonstration</h2>
                
                <%
                ' File Loading Test
                Dim fileStartTime, fileLoadTime, fileParseTime
                fileStartTime = Timer
                
                Dim fso, jsonFile, jsonContent, fileSize
                Set fso = Server.CreateObject("Scripting.FileSystemObject")
                
                On Error Resume Next
                Set jsonFile = fso.OpenTextFile(Server.MapPath(demoSampleFile), 1)
                If Err.Number = 0 Then
                    jsonContent = jsonFile.ReadAll()
                    jsonFile.Close()
                    fileSize = Len(jsonContent)
                    fileLoadTime = Timer
                    
                    ' Parse the loaded JSON
                    Set parsedData = json.Parse(jsonContent)
                    fileParseTime = Timer
                    
                    If Not (parsedData Is Nothing) And json.LastError = "" Then
                        ' Successful parse - test access
                        
                        ' Test data access to verify parse success
                        Dim testCompanyName
                        
                        ' Test data access to verify parse success
                        testCompanyName = json.GetValue("company.name", "")
                        
                        If testCompanyName <> "" Then
                            testResults("fileLoad") = True
                            testResults("fileLoadTime") = (fileLoadTime - fileStartTime) * 1000
                            testResults("fileParseTime") = (fileParseTime - fileLoadTime) * 1000
                            testResults("fileSize") = fileSize
                            
                            Response.Write "<div class='info-box success'>"
                            Response.Write "<h3>‚úÖ File Loading & Parse Success</h3>"
                            Response.Write "<strong>File:</strong> " & demoSampleFile & "<br>"
                            Response.Write "<strong>Size:</strong> <span class='number'>" & FormatNumber(fileSize, 0) & "</span> characters<br>"
                            Response.Write "<strong>Load Time:</strong> <span class='number'>" & FormatNumber(testResults("fileLoadTime"), 2) & "</span>ms<br>"
                            Response.Write "<strong>Parse Time:</strong> <span class='number'>" & FormatNumber(testResults("fileParseTime"), 2) & "</span>ms<br>"
                            Response.Write "<strong>Root Sections:</strong> <span class='number'>" & UBound(json.GetKeys()) + 1 & "</span><br>"
                            Response.Write "<strong>Data Verification:</strong> <span class='string'>" & testCompanyName & "</span>"
                            Response.Write "</div>"
                        Else
                            testResults("fileLoad") = False
                            Response.Write "<div class='info-box error'>"
                            Response.Write "<h3>‚ùå Data Access Failed</h3>"
                            Response.Write "<strong>Parse Status:</strong> Object created but data access failed<br>"
                            Response.Write "<strong>Error:</strong> " & json.LastError & "<br>"
                            Response.Write "<strong>Debug:</strong> Company name test returned empty"
                            Response.Write "</div>"
                        End If
                    Else
                        testResults("fileLoad") = False
                        Response.Write "<div class='info-box error'>"
                        Response.Write "<h3>‚ùå JSON Parsing Failed</h3>"
                        Response.Write "<strong>Error:</strong> " & json.LastError & "<br>"
                        If parsedData Is Nothing Then
    Response.Write "<strong>Parse Result:</strong> Nothing object<br>"
Else
    Response.Write "<strong>Parse Result:</strong> Object created<br>"
End If
                        Response.Write "<strong>JSON Preview:</strong> " & Left(jsonContent, 100) & "..."
                        Response.Write "</div>"
                    End If
                Else
                    testResults("fileLoad") = False
                    Response.Write "<div class='info-box error'>"
                    Response.Write "<h3>‚ùå File Loading Failed</h3>"
                    Response.Write "<strong>File:</strong> " & demoSampleFile & "<br>"
                    Response.Write "<strong>Error:</strong> " & Err.Description
                    Response.Write "</div>"
                End If
                On Error Goto 0
                Set fso = Nothing
                %>
                
                <!-- Quick Data Preview -->
                <% If testResults("fileLoad") Then %>
                <div class="info-box info">
                    <h4>üìã Quick Data Preview</h4>
                    <p><strong>Company:</strong> <span class='string'><%= json.GetValue("company.name", "N/A") %></span></p>
                    <p><strong>Employees:</strong> <span class='number'><%= FormatNumber(json.GetValue("company.employees", 0), 0) %></span></p>
                    <p><strong>Founded:</strong> <span class='number'><%= json.GetValue("company.founded", 0) %></span></p>
                    <p><strong>Location:</strong> <span class='string'><%= json.GetValue("company.headquarters.city", "N/A") %>, <%= json.GetValue("company.headquarters.country", "N/A") %></span></p>
                </div>
                <% Else %>
                <div class="info-box warning">
                    <h4>‚ö†Ô∏è Data Preview Unavailable</h4>
                    <p><strong>Parse Status:</strong> <% 
                        If testResults.Exists("fileLoad") And testResults("fileLoad") Then 
                            Response.Write "Success" 
                        Else 
                            Response.Write "Failed" 
                        End If 
                    %></p>
                    <p><strong>Last Error:</strong> <%= json.LastError %></p>
                    <% If testResults("fileLoad") Then %>
                    <p><strong>Debug Info:</strong> File loaded and parsed but data access failing</p>
                    <% End If %>
                </div>
                <% End If %>
            </div>
        </div>

        <!-- Tab 2: HTTP Loading Demo -->
        <div id="http-content" class="tab-content">
            <div class="demo-section">
                <h2>üåê HTTP URL Loading Demonstration</h2>
                
                <!-- Test 1: JSONPlaceholder API -->
                <h3>üîó Test 1: JSONPlaceholder API</h3>
                <%
                Dim http1StartTime, http1EndTime, json1, parsed1
                http1StartTime = Timer
                
                Set json1 = CreateRabbitJSON()
                Set parsed1 = json1.Parse(demoApiUrl1)
                
                http1EndTime = Timer
                
                If Not (parsed1 Is Nothing) Then
                    testResults("api1Load") = True
                    testResults("api1Time") = (http1EndTime - http1StartTime) * 1000
                    
                    Set json1.Data = parsed1
                    
                    Response.Write "<div class='info-box success'>"
                    Response.Write "<h4>‚úÖ SUCCESS - JSONPlaceholder API</h4>"
                    Response.Write "<strong>URL:</strong> <span class='url'>" & demoApiUrl1 & "</span><br>"
                    Response.Write "<strong>Response Time:</strong> <span class='number'>" & FormatNumber(testResults("api1Time"), 2) & "</span>ms<br>"
                    Response.Write "<strong>Data Keys:</strong> <span class='number'>" & UBound(json1.GetKeys()) + 1 & "</span>"
                    Response.Write "</div>"
                    
                    Response.Write "<table>"
                    Response.Write "<tr><th>Field</th><th>Value</th></tr>"
                    Response.Write "<tr><td>Post ID</td><td class='number'>" & json1.GetValue("id", "N/A") & "</td></tr>"
                    Response.Write "<tr><td>User ID</td><td class='number'>" & json1.GetValue("userId", "N/A") & "</td></tr>"
                    Response.Write "<tr><td>Title</td><td class='string'>" & Left(json1.GetValue("title", "N/A"), 60) & "...</td></tr>"
                    Response.Write "<tr><td>Body Length</td><td class='number'>" & Len(json1.GetValue("body", "")) & " chars</td></tr>"
                    Response.Write "</table>"
                Else
                    testResults("api1Load") = False
                    Response.Write "<div class='info-box error'>"
                    Response.Write "<h4>‚ùå FAILED - JSONPlaceholder API</h4>"
                    Response.Write "<strong>Error:</strong> " & json1.LastError
                    Response.Write "</div>"
                End If
                %>
                
                <!-- Test 2: GitHub API -->
                <h3>üîó Test 2: GitHub API</h3>
                <%
                Dim http2StartTime, http2EndTime, json2, parsed2
                http2StartTime = Timer
                
                Set json2 = CreateRabbitJSON()
                Set parsed2 = json2.Parse(demoApiUrl2)
                
                http2EndTime = Timer
                
                If Not (parsed2 Is Nothing) Then
                    testResults("api2Load") = True
                    testResults("api2Time") = (http2EndTime - http2StartTime) * 1000
                    
                    Set json2.Data = parsed2
                    
                    Response.Write "<div class='info-box success'>"
                    Response.Write "<h4>‚úÖ SUCCESS - GitHub API</h4>"
                    Response.Write "<strong>URL:</strong> <span class='url'>" & demoApiUrl2 & "</span><br>"
                    Response.Write "<strong>Response Time:</strong> <span class='number'>" & FormatNumber(testResults("api2Time"), 2) & "</span>ms<br>"
                    Response.Write "<strong>Data Keys:</strong> <span class='number'>" & UBound(json2.GetKeys()) + 1 & "</span>"
                    Response.Write "</div>"
                    
                    Response.Write "<table>"
                    Response.Write "<tr><th>Field</th><th>Value</th></tr>"
                    Response.Write "<tr><td>Username</td><td class='string'>" & json2.GetValue("login", "N/A") & "</td></tr>"
                    Response.Write "<tr><td>Name</td><td class='string'>" & json2.GetValue("name", "N/A") & "</td></tr>"
                    Response.Write "<tr><td>Public Repos</td><td class='number'>" & FormatNumber(json2.GetValue("public_repos", 0), 0) & "</td></tr>"
                    Response.Write "<tr><td>Followers</td><td class='number'>" & FormatNumber(json2.GetValue("followers", 0), 0) & "</td></tr>"
                    Response.Write "<tr><td>Following</td><td class='number'>" & FormatNumber(json2.GetValue("following", 0), 0) & "</td></tr>"
                    Response.Write "</table>"
                Else
                    testResults("api2Load") = False
                    Response.Write "<div class='info-box error'>"
                    Response.Write "<h4>‚ùå FAILED - GitHub API</h4>"
                    Response.Write "<strong>Error:</strong> " & json2.LastError
                    Response.Write "</div>"
                End If
                %>
                
                <!-- Backward Compatibility Test -->
                <h3>üìÑ Test 3: Backward Compatibility (JSON String)</h3>
                <%
                Dim compatStartTime, compatEndTime, json3, parsed3
                compatStartTime = Timer
                
                Dim compatJsonStr
                compatJsonStr = "{""test"":""RabbitJSON v2.1.1"",""features"":[""file-loading"",""http-loading"",""path-access""],""version"":2.11,""ready"":true}"
                
                Set json3 = CreateRabbitJSON()
                Set parsed3 = json3.Parse(compatJsonStr)
                
                compatEndTime = Timer
                
                If Not (parsed3 Is Nothing) Then
                    testResults("compatLoad") = True
                    testResults("compatTime") = (compatEndTime - compatStartTime) * 1000
                    
                    Set json3.Data = parsed3
                    
                    Response.Write "<div class='info-box success'>"
                    Response.Write "<h4>‚úÖ SUCCESS - Backward Compatibility</h4>"
                    Response.Write "<strong>Input:</strong> Direct JSON String<br>"
                    Response.Write "<strong>Parse Time:</strong> <span class='number'>" & FormatNumber(testResults("compatTime"), 2) & "</span>ms<br>"
                    Response.Write "<strong>Features:</strong> URL detection did not interfere with JSON parsing"
                    Response.Write "</div>"
                Else
                    testResults("compatLoad") = False
                    Response.Write "<div class='info-box error'>"
                    Response.Write "<h4>‚ùå FAILED - Backward Compatibility</h4>"
                    Response.Write "<strong>Error:</strong> " & json3.LastError
                    Response.Write "</div>"
                End If
                %>
            </div>
        </div>

        <!-- Tab 3: Data Analysis -->
        <div id="analysis-content" class="tab-content">
            <% If testResults("fileLoad") Then %>
            <div class="demo-section">
                <h2>üìä Comprehensive Data Analysis</h2>
                
                <!-- Company Analysis -->
                <h3>üè¢ Company Information</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h4><%= json.GetValue("company.name", "N/A") %></h4>
                        <p>Company</p>
                    </div>
                    <div class="stat-card">
                        <h4><%= FormatNumber(json.GetValue("company.employees", 0), 0) %></h4>
                        <p>Employees</p>
                    </div>
                    <div class="stat-card">
                        <h4><%= json.GetValue("company.founded", 0) %></h4>
                        <p>Founded</p>
                    </div>
                    <div class="stat-card">
                        <h4><%= json.GetValue("company.headquarters.city", "N/A") %></h4>
                        <p>Headquarters</p>
                    </div>
                </div>
                
                <!-- Products Analysis -->
                <h3>üì¶ Products Portfolio</h3>
                <table>
                    <tr>
                        <th>Product</th>
                        <th>Category</th>
                        <th>Price</th>
                        <th>Downloads</th>
                        <th>Rating</th>
                        <th>Open Source</th>
                    </tr>
                    <%
                    For i = 0 To 1
                        Response.Write "<tr>"
                        Response.Write "<td class='string'>" & json.GetValue("products." & i & ".name", "N/A") & "</td>"
                        Response.Write "<td class='string'>" & json.GetValue("products." & i & ".category", "N/A") & "</td>"
                        Response.Write "<td class='number'>$" & json.GetValue("products." & i & ".price", 0) & "</td>"
                        Response.Write "<td class='number'>" & FormatNumber(json.GetValue("products." & i & ".downloads.total", 0), 0) & "</td>"
                        Response.Write "<td class='number'>" & json.GetValue("products." & i & ".ratings.average", 0) & "/5</td>"
                        Response.Write "<td class='boolean'>" & json.GetValue("products." & i & ".isOpenSource", False) & "</td>"
                        Response.Write "</tr>"
                    Next
                    %>
                </table>
                
                <!-- Analytics Dashboard -->
                <h3>üìà Analytics Dashboard</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h4><%= FormatNumber(json.GetValue("analytics.traffic.dailyVisitors", 0), 0) %></h4>
                        <p>Daily Visitors</p>
                    </div>
                    <div class="stat-card">
                        <h4><%= FormatNumber(json.GetValue("analytics.traffic.monthlyVisitors", 0), 0) %></h4>
                        <p>Monthly Visitors</p>
                    </div>
                    <div class="stat-card">
                        <h4><%= FormatNumber(json.GetValue("analytics.traffic.pageViews", 0), 0) %></h4>
                        <p>Page Views</p>
                    </div>
                    <div class="stat-card">
                        <h4><%= FormatNumber(json.GetValue("analytics.traffic.bounceRate", 0) * 100, 1) %>%</h4>
                        <p>Bounce Rate</p>
                    </div>
                </div>
                
                <!-- Geographic Distribution -->
                <h4>üåç Geographic Distribution</h4>
                <table>
                    <tr>
                        <th>Country</th>
                        <th>Percentage</th>
                        <th>Visitors</th>
                    </tr>
                    <%
                    For i = 0 To 4
                        Response.Write "<tr>"
                        Response.Write "<td class='string'>" & json.GetValue("analytics.geographical.topCountries." & i & ".country", "N/A") & "</td>"
                        Response.Write "<td class='number'>" & json.GetValue("analytics.geographical.topCountries." & i & ".percentage", 0) & "%</td>"
                        Response.Write "<td class='number'>" & FormatNumber(json.GetValue("analytics.geographical.topCountries." & i & ".visitors", 0), 0) & "</td>"
                        Response.Write "</tr>"
                    Next
                    %>
                </table>
                
                <!-- System Information -->
                <h3>üñ•Ô∏è System Information</h3>
                <table>
                    <tr>
                        <th>Component</th>
                        <th>Value</th>
                    </tr>
                    <tr><td>Operating System</td><td class='string'><%= json.GetValue("systemInfo.server.os", "N/A") %></td></tr>
                    <tr><td>IIS Version</td><td class='string'><%= json.GetValue("systemInfo.server.iisVersion", "N/A") %></td></tr>
                    <tr><td>ASP Version</td><td class='string'><%= json.GetValue("systemInfo.server.aspVersion", "N/A") %></td></tr>
                    <tr><td>VBScript Version</td><td class='string'><%= json.GetValue("systemInfo.server.vbscriptVersion", "N/A") %></td></tr>
                    <tr><td>CPU Model</td><td class='string'><%= json.GetValue("systemInfo.server.cpu.model", "N/A") %></td></tr>
                    <tr><td>CPU Cores</td><td class='number'><%= json.GetValue("systemInfo.server.cpu.cores", 0) %></td></tr>
                    <tr><td>Total Memory</td><td class='string'><%= json.GetValue("systemInfo.server.memory.total", "N/A") %></td></tr>
                    <tr><td>Available Memory</td><td class='string'><%= json.GetValue("systemInfo.server.memory.available", "N/A") %></td></tr>
                </table>
                
                <!-- Special Data Types -->
                <h3>üß™ Special Data Types Testing</h3>
                <div class="info-box info">
                    <p><strong>Unicode:</strong> <span class='string'><%= json.GetValue("testData.specialCharacters", "N/A") %></span></p>
                    <p><strong>Emojis:</strong> <span class='string'><%= json.GetValue("testData.unicodeEmojis", "N/A") %></span></p>
                    <p><strong>Large Number:</strong> <span class='number'><%= json.GetValue("testData.numbers.large", 0) %></span></p>
                    <p><strong>Scientific:</strong> <span class='number'><%= json.GetValue("testData.numbers.scientific", 0) %></span></p>
                    <p><strong>Boolean True:</strong> <span class='boolean'><%= json.GetValue("testData.booleans.trueValue", False) %></span></p>
                    <p><strong>Boolean False:</strong> <span class='boolean'><%= json.GetValue("testData.booleans.falseValue", True) %></span></p>
                    <%
                    Dim nullValue
                    nullValue = json.GetValue("testData.nullValue", "NOT_NULL")
                    If IsNull(nullValue) Then
                        Response.Write "<p><strong>Null Value:</strong> <span class='null'>null (correctly parsed)</span></p>"
                    Else
                        Response.Write "<p><strong>Null Value:</strong> <span class='error'>Error - not null!</span></p>"
                    End If
                    %>
                </div>
            </div>
            <% Else %>
            <div class="info-box warning">
                <h3>‚ö†Ô∏è Data Analysis Unavailable</h3>
                <p>Please ensure the file loading was successful to view data analysis.</p>
            </div>
            <% End If %>
        </div>

        <!-- Tab 4: Performance Analysis -->
        <div id="performance-content" class="tab-content">
            <%
            endTime = Timer
            totalTime = (endTime - startTime) * 1000
            %>
            <div class="demo-section">
                <h2>‚ö° Performance Analysis & Benchmarks</h2>
                
                <!-- Performance Summary -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <h4><%= FormatNumber(totalTime, 2) %>ms</h4>
                        <p>Total Demo Time</p>
                    </div>
                    <% If testResults.Exists("fileLoadTime") Then %>
                    <div class="stat-card">
                        <h4><%= FormatNumber(testResults("fileLoadTime"), 2) %>ms</h4>
                        <p>File Load Time</p>
                    </div>
                    <% End If %>
                    <% If testResults.Exists("api1Time") Then %>
                    <div class="stat-card">
                        <h4><%= FormatNumber(testResults("api1Time"), 2) %>ms</h4>
                        <p>API 1 Response</p>
                    </div>
                    <% End If %>
                    <% If testResults.Exists("api2Time") Then %>
                    <div class="stat-card">
                        <h4><%= FormatNumber(testResults("api2Time"), 2) %>ms</h4>
                        <p>API 2 Response</p>
                    </div>
                    <% End If %>
                </div>
                
                <!-- Detailed Performance Table -->
                <h3>üìä Detailed Performance Metrics</h3>
                <table>
                    <tr>
                        <th>Operation</th>
                        <th>Time (ms)</th>
                        <th>Status</th>
                        <th>Details</th>
                    </tr>
                    <% If testResults.Exists("fileLoadTime") Then %>
                    <tr>
                        <td>File Loading</td>
                        <td class='number'><%= FormatNumber(testResults("fileLoadTime"), 2) %></td>
                        <td class='<%= IIf(testResults("fileLoad"), "success", "error") %>'><%= IIf(testResults("fileLoad"), "‚úÖ Success", "‚ùå Failed") %></td>
                        <td><%= FormatNumber(testResults("fileSize"), 0) %> characters</td>
                    </tr>
                    <tr>
                        <td>File Parsing</td>
                        <td class='number'><%= FormatNumber(testResults("fileParseTime"), 2) %></td>
                        <td class='<%= IIf(testResults("fileLoad"), "success", "error") %>'><%= IIf(testResults("fileLoad"), "‚úÖ Success", "‚ùå Failed") %></td>
                        <td>JSON structure analysis</td>
                    </tr>
                    <% End If %>
                    <% If testResults.Exists("api1Time") Then %>
                    <tr>
                        <td>HTTP API 1</td>
                        <td class='number'><%= FormatNumber(testResults("api1Time"), 2) %></td>
                        <td class='<%= IIf(testResults("api1Load"), "success", "error") %>'><%= IIf(testResults("api1Load"), "‚úÖ Success", "‚ùå Failed") %></td>
                        <td>JSONPlaceholder API</td>
                    </tr>
                    <% End If %>
                    <% If testResults.Exists("api2Time") Then %>
                    <tr>
                        <td>HTTP API 2</td>
                        <td class='number'><%= FormatNumber(testResults("api2Time"), 2) %></td>
                        <td class='<%= IIf(testResults("api2Load"), "success", "error") %>'><%= IIf(testResults("api2Load"), "‚úÖ Success", "‚ùå Failed") %></td>
                        <td>GitHub API</td>
                    </tr>
                    <% End If %>
                    <% If testResults.Exists("compatTime") Then %>
                    <tr>
                        <td>JSON String Parse</td>
                        <td class='number'><%= FormatNumber(testResults("compatTime"), 2) %></td>
                        <td class='<%= IIf(testResults("compatLoad"), "success", "error") %>'><%= IIf(testResults("compatLoad"), "‚úÖ Success", "‚ùå Failed") %></td>
                        <td>Backward compatibility</td>
                    </tr>
                    <% End If %>
                </table>
                
                <!-- Performance Insights -->
                <div class="info-box performance">
                    <h4>üîç Performance Insights</h4>
                    <% If testResults.Exists("fileSize") And testResults.Exists("fileParseTime") Then %>
                    <p><strong>Parse Speed:</strong> <span class='number'><%= FormatNumber(testResults("fileSize") / testResults("fileParseTime"), 0) %></span> characters/ms</p>
                    <% End If %>
                    <p><strong>Memory Usage:</strong> Automatic cleanup enabled</p>
                    <p><strong>Error Handling:</strong> Comprehensive error detection</p>
                    <p><strong>URL Detection:</strong> Smart HTTP/HTTPS recognition</p>
                </div>
                
                <!-- Code Examples -->
                <h3>üíª Usage Code Examples</h3>
                <div class="code">
<strong>RabbitJSON v2.1.1 Usage Examples:</strong>

' File Loading Example
Set json = CreateRabbitJSON()
Set data = json.Parse("sample-data.json")  ' File path
companyName = json.GetValue("company.name", "")

' HTTP URL Loading Example  
Set apiData = json.Parse("https://api.github.com/users/octocat")  ' HTTP URL
username = json.GetValue("login", "")

' Regular JSON String (Backward Compatible)
Set localData = json.Parse("{""key"":""value""}")  ' JSON string
value = json.GetValue("key", "")

' Path-based Data Access
employeeCount = json.GetValue("company.employees", 0)
latitude = json.GetValue("company.headquarters.address.coordinates.latitude", 0)
firstProductName = json.GetValue("products.0.name", "")

' Data Manipulation
json.SetValue "demo.timestamp", Now()
json.SetValue "demo.processed", True
hasValue = json.HasValue("analytics.traffic")

' Serialization
compactJson = json.StringifyCompact(json.Data)
formattedJson = json.Stringify(json.Data, 2)
                </div>
            </div>
        </div>

        <!-- Summary Section -->
        <div class="demo-section">
            <div class="info-box success">
                <h3>üéâ RabbitJSON v2.1.1 - Comprehensive Demo Complete!</h3>
                <p><strong>Demonstrated Features:</strong></p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin-top: 15px;">
                    <div>
                        <strong>‚úÖ Core Features:</strong>
                        <ul style="margin: 5px 0;">
                            <li>JSON file loading</li>
                            <li>HTTP URL loading</li>
                            <li>Path-based data access</li>
                            <li>Data serialization</li>
                        </ul>
                    </div>
                    <div>
                        <strong>‚úÖ Data Types:</strong>
                        <ul style="margin: 5px 0;">
                            <li>String, Number, Boolean</li>
                            <li>Null values</li>
                            <li>Objects and Arrays</li>
                            <li>Unicode support</li>
                        </ul>
                    </div>
                    <div>
                        <strong>‚úÖ Performance:</strong>
                        <ul style="margin: 5px 0;">
                            <li>Fast parsing engine</li>
                            <li>Memory efficient</li>
                            <li>Error handling</li>
                            <li>Auto cleanup</li>
                        </ul>
                    </div>
                </div>
                <p style="margin-top: 15px;"><strong>Total Demo Time:</strong> <span class='number'><%= FormatNumber(totalTime, 2) %>ms</span></p>
            </div>
        </div>

        <%
        ' Cleanup
        Set json = Nothing
        Set json1 = Nothing
        Set json2 = Nothing
        Set json3 = Nothing
        Set parsedData = Nothing
        Set parsed1 = Nothing
        Set parsed2 = Nothing
        Set parsed3 = Nothing
        Set testResults = Nothing
        %>
    </div>

    <script>
        // Auto-activate first tab
        document.addEventListener('DOMContentLoaded', function() {
            showTab('file');
        });
    </script>
</body>
</html> 